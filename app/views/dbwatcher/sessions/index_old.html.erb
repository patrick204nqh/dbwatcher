<div class="h-full flex flex-col">
  <!-- Compact Header -->
  <div class="h-10 bg-navy-dark text-white flex items-center px-4">
    <h1 class="text-sm font-medium">Tracking Sessions</h1>
    <span class="ml-auto text-xs text-blue-light">
      <%= @sessions.count %> sessions
    </span>
  </div>
  
  <!-- Tab Bar -->
  <div class="tab-bar">
    <div class="tab-item active">All Sessions</div>
    <div class="tab-item">Active</div>
    <div class="tab-item">Recent</div>
  </div>
  
  <!-- Toolbar -->
  <div class="h-8 bg-gray-100 border-b border-gray-300 flex items-center px-4 gap-2">
    <input type="text" placeholder="Filter sessions..." 
           class="compact-input flex-1 max-w-xs">
    <select class="compact-select">
      <option>Last 24 hours</option>
      <option>Last week</option>
      <option>All time</option>
    </select>
    
    <div class="ml-auto flex items-center gap-2">
      <button class="compact-button bg-blue-medium text-white hover:bg-blue-700">
        <svg class="w-3 h-3 inline mr-1" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd"/>
        </svg>
        Refresh
      </button>
      
      <%= button_to clear_sessions_path, 
                    method: :delete,
                    class: "compact-button bg-red-600 text-white hover:bg-red-700",
                    data: { 
                      confirm: "Are you sure you want to clear all sessions? This action cannot be undone." 
                    } do %>
        <svg class="w-3 h-3 inline mr-1" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 012 0v4a1 1 0 11-2 0V7zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V7a1 1 0 00-1-1z"/>
        </svg>
        Clear Sessions
      <% end %>
    </div>
  </div>
  
  <!-- Content -->
  <div class="flex-1 overflow-auto">
    <% if @sessions.empty? %>
      <div class="flex items-center justify-center h-full text-gray-500">
        <div class="text-center">
          <svg class="mx-auto h-8 w-8 text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" 
                  d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
          </svg>
          <p class="text-xs">No tracking sessions yet</p>
          <p class="text-xs text-gray-400">Start tracking with <code class="bg-gray-200 px-1 rounded">Dbwatcher.track { ... }</code></p>
        </div>
      </div>
    <% else %>
      <table class="compact-table w-full">
        <thead>
          <tr>
            <th class="text-left">Session Name</th>
            <th class="text-center">Started</th>
            <th class="text-center">Duration</th>
            <th class="text-center">Changes</th>
            <th class="text-center">Status</th>
            <th class="text-right">Actions</th>
          </tr>
        </thead>
        <tbody>
          <% @sessions.each do |session| %>
            <tr class="cursor-pointer" onclick="window.location='<%= session_path(session[:id]) %>'">
              <td class="font-medium text-navy-dark">
                <div class="flex items-center gap-2">
                  <svg class="w-3 h-3 text-blue-medium" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                  </svg>
                  <span class="truncate max-w-xs" title="<%= session[:name] %>">
                    <%= session[:name].to_s.gsub(/^HTTP \w+ /, '') %>
                  </span>
                </div>
              </td>
              <td class="text-center text-gray-600">
                <%= Time.parse(session[:started_at]).strftime("%m/%d %H:%M") rescue 'N/A' %>
              </td>
              <td class="text-center text-gray-600">
                <% if session[:ended_at] && session[:started_at] %>
                  <% duration = Time.parse(session[:ended_at]) - Time.parse(session[:started_at]) rescue 0 %>
                  <%= '%.2f' % duration %>s
                <% else %>
                  <span class="text-gray-400">-</span>
                <% end %>
              </td>
              <td class="text-center">
                <% change_count = session[:change_count] || 0 %>
                <% if change_count > 0 %>
                  <span class="badge bg-blue-medium text-white"><%= change_count %></span>
                <% else %>
                  <span class="text-gray-400">0</span>
                <% end %>
              </td>
              <td class="text-center">
                <% if session[:ended_at] %>
                  <span class="badge bg-gray-500 text-white">Complete</span>
                <% else %>
                  <span class="badge bg-gold-dark text-white">Active</span>
                <% end %>
              </td>
              <td class="text-right">
                <div class="flex gap-1 justify-end">
                  <%= link_to session_path(session[:id]), 
                      class: "compact-button bg-navy-dark text-white hover:bg-blue-medium", 
                      title: "View Details" do %>
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                            d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                            d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                    </svg>
                  <% end %>
                </div>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% end %>
  </div>
  
  <!-- Status Bar -->
  <div class="h-6 bg-gray-100 border-t border-gray-300 flex items-center px-4 text-xs text-gray-600">
    <%= @sessions.count %> sessions total • 
    <%= @sessions.count { |s| !(s[:ended_at] || s['ended_at']) } %> active •
    Last updated: <%= Time.current.strftime("%H:%M:%S") %>
  </div>
</div>

