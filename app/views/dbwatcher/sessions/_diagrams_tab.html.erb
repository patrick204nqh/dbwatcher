<!-- Diagrams Tab -->
<div x-show="activeTab === 'diagrams'" class="h-full">
  <div class="p-4">
    <!-- Diagram Controls -->
    <div class="mb-4 flex gap-2 items-center flex-wrap">
      <select x-model="selectedDiagramType" @change="loadDiagram()" class="compact-select">
        <option value="database_tables">Database Tables (Schema)</option>
        <option value="model_associations">Model Associations</option>
      </select>

      <button @click="loadDiagram()"
              class="compact-button bg-blue-medium text-white hover:bg-blue-dark">
        Generate Diagram
      </button>

      <button @click="exportDiagram()"
              class="compact-button bg-white border border-gray-300 hover:bg-gray-50"
              x-show="diagramContent">
        Export SVG
      </button>

      <!-- Reset View Button (native interactions handle zoom/pan) -->
      <div class="flex items-center gap-1 ml-auto" x-show="diagramContent">
        <button @click="resetView()" class="compact-button bg-white border border-gray-300 hover:bg-gray-50 text-xs">
          Reset View
        </button>
      </div>
    </div>

    <!-- Diagram Container -->
    <div class="border border-gray-300 rounded bg-white min-h-96">
      <!-- Empty State -->
      <div x-show="!diagramContent && !loading" class="p-8 text-center text-gray-500">
        <svg class="w-12 h-12 mx-auto mb-2 text-gray-400" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1"
                d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
        </svg>
        <p class="text-sm">Select a diagram type and click Generate</p>
      </div>

      <!-- Loading State -->
      <div x-show="loading" class="p-8 text-center">
        <div class="animate-pulse flex flex-col items-center">
          <div class="w-12 h-12 bg-blue-100 rounded-full mb-2 flex items-center justify-center">
            <svg class="w-6 h-6 text-blue-medium animate-spin" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
          </div>
          <div class="text-sm text-gray-500">Generating diagram...</div>
        </div>
      </div>

      <!-- Diagram Content -->
      <div id="diagram-container"
           x-show="diagramContent"
           class="p-4 overflow-hidden">
        <!-- Mermaid diagram will be rendered here with native interactions -->
      </div>

      <!-- Error State -->
      <div x-show="diagramError" class="p-4 text-red-600 bg-red-50 border border-red-200 rounded m-4">
        <p class="font-medium mb-2">Error rendering diagram</p>
        <p class="text-sm mb-2" x-text="diagramError"></p>
        <button @click="diagramError = null; loadDiagram()" class="compact-button bg-red-600 text-white hover:bg-red-700">
          Try Again
        </button>
      </div>
    </div>
  </div>
</div>
